---
title: "Descriptive Statistics"
output: html_notebook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_packages}
# # Ensure that pacman is installed for package management and loading.
# if (!require("pacman")) install.packages("pacman")
# # for data reading wrangling and visualization
pacman::p_load(tidyverse) 
# for working directories
pacman::p_load(here) 
# # for cross tabulation and data cleaning
# pacman::p_load(janitor) 
# for working with strings
pacman::p_load(glue) 
# For randomized inference, also loads randomizr and estimatr 
pacman::p_load(ri2) 
# for marginal effects from lineal regressions
pacman::p_load(margins)
# Tests for linear regression models
pacman::p_load(lmtest)
pacman::p_load(car)
# Tables
pacman::p_load(kableExtra)
# for updated  theme
pacman::p_load(hrbrthemes)
# for updated  colorblind-friendly scheme
pacman::p_load(ggthemes)
# theme_set(hrbrthemes::theme_ipsum())
pacman::p_load(reshape2)
# for plotting of covariate balance
pacman::p_load(cobalt)
# for matching only
# pacman::p_load(MatchIt)
```

```{r read_data}
#download the data from GitHub
data <-'https://raw.githubusercontent.com/gsbDBI/ALP301-spr21-project3/main/rla_clean_5_12.csv'
df <- read.csv(data)
rm(data) #remove data csv file
```

```{r glimpse_data}
tibble::glimpse(df) # overview of variables in the data
```

```{r treatment table}

#table() creates a contingency table of observations in each treatment condition
with(df, table(treatment_group, useNA = 'ifany')) %>%  # "ifany" includes the NA values in the table
  knitr::kable() %>%                                            #kabel(x, format) generates tables 
  # add in a header to label what we're cross-tabulating with
  add_header_above(c('treatment_group' = 2)) %>% #add_header_above(x, col_name=col_span)
  kableExtra::kable_styling(bootstrap_options = "striped") #additional styling options

```

```{r_state_vs_national}

# Confidence at the state level is higher than confidence at the national level
mean(df$dv_pre_state_conf)
mean(df$dv_pre_national_conf)
mean(df$dv_post_state_conf)
mean(df$dv_post_national_conf)
t.test(df$dv_pre_state_conf,df$dv_pre_national_conf)
t.test(df$dv_post_state_conf,df$dv_post_national_conf)

# Is it possible to overlay these four graphs?
df %>%
  ggplot( aes(x=dv_pre_state_conf)) +
    geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.8)
    geom_vline(aes(xintercept=mean(dv_pre_state_conf)),
            color="blue", linetype="dashed", size=1)
df %>%
  ggplot( aes(x=dv_pre_national_conf)) +
    geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.8)
df %>%
  ggplot( aes(x=dv_post_state_conf)) +
    geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.8)
df %>%
  ggplot( aes(x=dv_post_national_conf)) +
    geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.8)

# Is it possible to show the means in each of these graphs?


```

``` {r always_believers}

# Trust in elections is polarized by who won.
# Always believers are subjects that in both the 2016 and the 2020 presidential elections votes were counted accurately. 

# 50% believe both elections were fair
table(df$always_believer)/sum(table(df$always_believer))
# 13% believe only one election was fair
table(df$never_believer)/sum(table(df$never_believer))

```


